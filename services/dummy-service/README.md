
# üß† `dummy-service`: Telemetry & Command Simulation Microservice

`dummy-service` ‚Äî —ç—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å StreamForge, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è:

* –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –∏–∑ Kafka (`queue-control`);
* –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π (`started`, `pong`, `interrupted`, `finished`) –≤ Kafka (`queue-events`);
* –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫;
* –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ structured JSON;
* –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Prometheus-–º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ HTTP (`/metrics`);
* –∑–∞–ø—É—Å–∫–∞ –≤ Kubernetes –∫–∞–∫ `Job`, `Pod`, `Deployment` –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è            | –û–ø–∏—Å–∞–Ω–∏–µ                                                      |
| ------------------ | ------------------------------------------------------------- |
| `ping/pong`        | –†–µ–∞–∫—Ü–∏—è –Ω–∞ `ping` –∫–æ–º–∞–Ω–¥—É, –æ—Ç–ø—Ä–∞–≤–∫–∞ `pong` —Å –º–µ—Ç–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏   |
| `stop`             | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ –∫–æ–º–∞–Ω–¥–µ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π `interrupted` —Å–æ–±—ã—Ç–∏—è     |
| `simulate-loading` | –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ `loading` —Å–æ–±—ã—Ç–∏–π –≤ Kafka              |
| `fail-after N`     | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ `error` –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `N` —Å–µ–∫—É–Ω–¥ |
| `/metrics`         | –≠–∫—Å–ø–æ—Ä—Ç Prometheus-–º–µ—Ç—Ä–∏–∫ (—Å—á—ë—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π, —Å—Ç–∞—Ç—É—Å)          |
| JSON-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ   | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å Fluent Bit / Loki       |

---

## üßæ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                      |
| ------------------------- | ----------------------------------------------- |
| `QUEUE_ID`                | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –æ—á–µ—Ä–µ–¥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, loader-...)    |
| `SYMBOL`                  | –¢–∏–∫–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä `BTCUSDT`                       |
| `TIME_RANGE`              | –î–∏–∞–ø–∞–∑–æ–Ω, –Ω–∞–ø—Ä–∏–º–µ—Ä `2024-01-01:2024-01-02`      |
| `TYPE`                    | –¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞: `api`, `ws`, `dummy`, ...        |
| `TELEMETRY_PRODUCER_ID`   | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ –≤ —Å–æ–±—ã—Ç–∏—è—Ö                |
| `KAFKA_TOPIC`             | –¶–µ–ª–µ–≤–æ–π Kafka-—Ç–æ–ø–∏–∫                             |
| `QUEUE_EVENTS_TOPIC`      | Kafka topic –¥–ª—è —Å–æ–±—ã—Ç–∏–π (–æ–±—ã—á–Ω–æ `queue-events`) |
| `QUEUE_CONTROL_TOPIC`     | Kafka topic –¥–ª—è –∫–æ–º–∞–Ω–¥ (–æ–±—ã—á–Ω–æ `queue-control`) |
| `KAFKA_BOOTSTRAP_SERVERS` | –ê–¥—Ä–µ—Å –±—Ä–æ–∫–µ—Ä–∞ Kafka                             |
| `KAFKA_USER`              | SCRAM-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å                              |
| `KAFKA_PASSWORD`          | SCRAM-–ø–∞—Ä–æ–ª—å                                    |
| `KAFKA_CA_PATH`           | –ü—É—Ç—å –∫ CA-—Ñ–∞–π–ª—É –¥–ª—è TLS                         |
| `ARANGO_*`                | –î–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ArangoDB (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)     |

---

## üèÅ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ `dummy-service` –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–Ω—É—Ç—Ä–∏ `devcontainer`), —Å–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–µ—Ä–≤–∏—Å–∞, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `-m` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∫ –º–æ–¥—É–ª—è:

```bash
cd /data/projects/stream-forge/services/dummy-service/
python3.11 -m app.main \
  --debug \
  --simulate-loading \
  --exit-after 30
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `debug_producer.py`

`debug_producer.py` ‚Äî —ç—Ç–æ CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –≤ Kafka-—Ç–æ–ø–∏–∫ `queue-control` –∏ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑ `queue-events`. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö —á–µ—Ä–µ–∑ Kafka.

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

*   **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ Kafka (ping/pong):**
    –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `ping` –∏ –æ–∂–∏–¥–∞–π—Ç–µ `pong` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–∑–æ–≤–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞.
    ```bash
    python3.11 debug_producer.py \
      --queue-id <–≤–∞—à-queue-id> \
      --command ping \
      --expect-pong
    ```

*   **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (stop):**
    –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–∏–≥–Ω–∞–ª `stop` —Ü–µ–ª–µ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.
    ```bash
    python3.11 debug_producer.py \
      --queue-id <–≤–∞—à-queue-id> \
      --command stop
    ```



---

## üß© –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–ª–∞–≥–∏ `main.py`

| –§–ª–∞–≥                 | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                |
| -------------------- | --------------------------------------------------------- |
| `--debug`            | –í–∫–ª—é—á–∞–µ—Ç DEBUG —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–æ–≤                              |
| `--noop`             | –¢–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ `started`, –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ Kafka consumer     |
| `--exit-on-ping`     | –ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `ping` –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ `pong` |
| `--exit-after N`     | –ó–∞–≤–µ—Ä—à–∞–µ—Ç —á–µ—Ä–µ–∑ `N` —Å–µ–∫—É–Ω–¥                                |
| `--simulate-loading` | –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `loading`                     |
| `--fail-after N`     | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `error` –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ `N` —Å–µ–∫—É–Ω–¥    |

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ (`/metrics`)

–î–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø–æ—Ä—Ç—É `8000`, –≤–∫–ª—é—á–∞—é—Ç:

* `dummy_events_total{event="started|pong|interrupted|..."}`
* `dummy_pings_total`, `dummy_pongs_total`
* `dummy_status_last{status="loading|interrupted|finished"}`

---

## üê≥ –ü—Ä–∏–º–µ—Ä `Dockerfile` –∑–∞–ø—É—Å–∫–∞

```dockerfile
CMD ["python3.11", "main.py", "--simulate-loading", "--exit-after", "30"]
```

---

## ‚ò∏Ô∏è Kubernetes Integration

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫ –∫–∞–∫ `Job` –∏–ª–∏ `Pod` —Å:

* `envFrom`: ConfigMap + Secret
* Volume –¥–ª—è CA (`/usr/local/share/ca-certificates/ca.crt`)
* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Kafka —á–µ—Ä–µ–∑ TLS + SCRAM

---

## üìÇ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ StreamForge

`dummy-service` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫:

* üîÑ —ç–º—É–ª—è—Ç–æ—Ä –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (`loader`)
* üì° –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ Kafka (`ping/pong`)
* üéØ CI/CD —Ç–µ—Å—Ç –∫–æ–º–∞–Ω–¥ `stop`, `interrupted`
* üîç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

